<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Functions and Programming | Forestry 472: Ecological Monitoring and Data Analysis</title>
  <meta name="description" content="Course book for FOR472: Ecological Monitoring and Data Analysis" />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Functions and Programming | Forestry 472: Ecological Monitoring and Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course book for FOR472: Ecological Monitoring and Data Analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Functions and Programming | Forestry 472: Ecological Monitoring and Data Analysis" />
  
  <meta name="twitter:description" content="Course book for FOR472: Ecological Monitoring and Data Analysis" />
  

<meta name="author" content="Andrew O. Finley and Jeffrey W. Doser" />


<meta name="date" content="2019-05-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="manipulating-data-with-dplyr.html">
<link rel="next" href="working-with-data-sources.html">
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<link href="libs/leaflet/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet/leaflet.js"></script>
<link href="libs/leafletfix/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding/leaflet.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>1</b> Data</a><ul>
<li class="chapter" data-level="1.1" data-path="data.html"><a href="data.html#fef"><i class="fa fa-check"></i><b>1.1</b> FEF Tree Biomass Data Set</a></li>
<li class="chapter" data-level="1.2" data-path="data.html"><a href="data.html#face-experiment-data-set"><i class="fa fa-check"></i><b>1.2</b> FACE Experiment Data Set</a></li>
<li class="chapter" data-level="1.3" data-path="data.html"><a href="data.html#pef"><i class="fa fa-check"></i><b>1.3</b> PEF Inventory and LiDAR Data Set</a></li>
<li class="chapter" data-level="1.4" data-path="data.html"><a href="data.html#looking-forward"><i class="fa fa-check"></i><b>1.4</b> Looking Forward</a></li>
<li class="chapter" data-level="1.5" data-path="data.html"><a href="data.html#how-to-learn-the-most-important-section-in-this-book"><i class="fa fa-check"></i><b>1.5</b> How to Learn (The Most Important Section in This Book!)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>2</b> Introduction to R and RStudio</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#obtaining-and-installing-r"><i class="fa fa-check"></i><b>2.1</b> Obtaining and Installing R</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#obtaining-and-installing-rstudio"><i class="fa fa-check"></i><b>2.2</b> Obtaining and Installing RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#using-r-and-rstudio"><i class="fa fa-check"></i><b>2.3</b> Using R and RStudio</a><ul>
<li class="chapter" data-level="2.3.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#r-as-a-calculator"><i class="fa fa-check"></i><b>2.3.1</b> R as a calculator</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#sec:dec"><i class="fa fa-check"></i><b>2.3.2</b> Basic descriptive statistics and graphics in R</a></li>
<li class="chapter" data-level="2.3.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#simple-linear-regression-in-r"><i class="fa fa-check"></i><b>2.3.3</b> Simple linear regression in R</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#how-to-learn"><i class="fa fa-check"></i><b>2.4</b> How to Learn</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#getting-help"><i class="fa fa-check"></i><b>2.5</b> Getting help</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#workspace-working-directory-and-keeping-organized"><i class="fa fa-check"></i><b>2.6</b> Workspace, working directory, and keeping organized</a></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#quality-of-r-code"><i class="fa fa-check"></i><b>2.7</b> Quality of R code</a><ul>
<li class="chapter" data-level="2.7.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#naming-files"><i class="fa fa-check"></i><b>2.7.1</b> Naming Files</a></li>
<li class="chapter" data-level="2.7.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#naming-variables"><i class="fa fa-check"></i><b>2.7.2</b> Naming Variables</a></li>
<li class="chapter" data-level="2.7.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#syntax"><i class="fa fa-check"></i><b>2.7.3</b> Syntax</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="scripts-r-markdown-and-reproducible-research.html"><a href="scripts-r-markdown-and-reproducible-research.html"><i class="fa fa-check"></i><b>3</b> Scripts, R Markdown, and Reproducible Research</a><ul>
<li class="chapter" data-level="3.1" data-path="scripts-r-markdown-and-reproducible-research.html"><a href="scripts-r-markdown-and-reproducible-research.html#scripts-in-r"><i class="fa fa-check"></i><b>3.1</b> Scripts in R</a></li>
<li class="chapter" data-level="3.2" data-path="scripts-r-markdown-and-reproducible-research.html"><a href="scripts-r-markdown-and-reproducible-research.html#r-markdown"><i class="fa fa-check"></i><b>3.2</b> R Markdown</a><ul>
<li class="chapter" data-level="3.2.1" data-path="scripts-r-markdown-and-reproducible-research.html"><a href="scripts-r-markdown-and-reproducible-research.html#creating-and-processing-r-markdown-documents"><i class="fa fa-check"></i><b>3.2.1</b> Creating and processing R Markdown documents</a></li>
<li class="chapter" data-level="3.2.2" data-path="scripts-r-markdown-and-reproducible-research.html"><a href="scripts-r-markdown-and-reproducible-research.html#text-lists-and-headers"><i class="fa fa-check"></i><b>3.2.2</b> Text: Lists and Headers</a></li>
<li class="chapter" data-level="3.2.3" data-path="scripts-r-markdown-and-reproducible-research.html"><a href="scripts-r-markdown-and-reproducible-research.html#code-chunks"><i class="fa fa-check"></i><b>3.2.3</b> Code Chunks</a></li>
<li class="chapter" data-level="3.2.4" data-path="scripts-r-markdown-and-reproducible-research.html"><a href="scripts-r-markdown-and-reproducible-research.html#output-formats-other-than-html"><i class="fa fa-check"></i><b>3.2.4</b> Output formats other than HTML</a></li>
<li class="chapter" data-level="3.2.5" data-path="scripts-r-markdown-and-reproducible-research.html"><a href="scripts-r-markdown-and-reproducible-research.html#latex-knitr-and-bookdown"><i class="fa fa-check"></i><b>3.2.5</b> LaTeX, knitr, and bookdown</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>4</b> Data Structures</a><ul>
<li class="chapter" data-level="4.1" data-path="data-structures.html"><a href="data-structures.html#vectors"><i class="fa fa-check"></i><b>4.1</b> Vectors</a><ul>
<li class="chapter" data-level="4.1.1" data-path="data-structures.html"><a href="data-structures.html#types-conversion-and-coercion"><i class="fa fa-check"></i><b>4.1.1</b> Types, Conversion, and Coercion</a></li>
<li class="chapter" data-level="4.1.2" data-path="data-structures.html"><a href="data-structures.html#accessing-specific-elements-of-vectors"><i class="fa fa-check"></i><b>4.1.2</b> Accessing Specific Elements of Vectors</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-structures.html"><a href="data-structures.html#factors"><i class="fa fa-check"></i><b>4.2</b> Factors</a></li>
<li class="chapter" data-level="4.3" data-path="data-structures.html"><a href="data-structures.html#names-of-objects-in-r"><i class="fa fa-check"></i><b>4.3</b> Names of objects in R</a></li>
<li class="chapter" data-level="4.4" data-path="data-structures.html"><a href="data-structures.html#missing-data-infinity-etc."><i class="fa fa-check"></i><b>4.4</b> Missing Data, Infinity, etc.</a><ul>
<li class="chapter" data-level="4.4.1" data-path="data-structures.html"><a href="data-structures.html#infinity-and-nan"><i class="fa fa-check"></i><b>4.4.1</b> Infinity and NaN</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-structures.html"><a href="data-structures.html#data-frames"><i class="fa fa-check"></i><b>4.5</b> Data Frames</a><ul>
<li class="chapter" data-level="4.5.1" data-path="data-structures.html"><a href="data-structures.html#accessing-specific-elements-of-data-frames"><i class="fa fa-check"></i><b>4.5.1</b> Accessing specific elements of data frames</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-structures.html"><a href="data-structures.html#lists"><i class="fa fa-check"></i><b>4.6</b> Lists</a><ul>
<li class="chapter" data-level="4.6.1" data-path="data-structures.html"><a href="data-structures.html#accessing-specific-elements-of-lists"><i class="fa fa-check"></i><b>4.6.1</b> Accessing specific elements of lists</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="data-structures.html"><a href="data-structures.html#subsetting-with-logical-vectors"><i class="fa fa-check"></i><b>4.7</b> Subsetting with Logical Vectors</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html"><i class="fa fa-check"></i><b>5</b> Manipulating Data with <code>dplyr</code></a><ul>
<li class="chapter" data-level="5.1" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#minnesota-tree-growth-data"><i class="fa fa-check"></i><b>5.1</b> Minnesota tree growth data</a></li>
<li class="chapter" data-level="5.2" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#improved-data-frames"><i class="fa fa-check"></i><b>5.2</b> Improved Data Frames</a></li>
<li class="chapter" data-level="5.3" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#filtering-data-by-row"><i class="fa fa-check"></i><b>5.3</b> Filtering Data By Row</a></li>
<li class="chapter" data-level="5.4" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#selecting-variables-by-column"><i class="fa fa-check"></i><b>5.4</b> Selecting Variables by Column</a></li>
<li class="chapter" data-level="5.5" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#pipes"><i class="fa fa-check"></i><b>5.5</b> Pipes</a></li>
<li class="chapter" data-level="5.6" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#arranging-data-by-row"><i class="fa fa-check"></i><b>5.6</b> Arranging Data by Row</a></li>
<li class="chapter" data-level="5.7" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#renaming-variables"><i class="fa fa-check"></i><b>5.7</b> Renaming Variables</a></li>
<li class="chapter" data-level="5.8" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#creating-new-variables"><i class="fa fa-check"></i><b>5.8</b> Creating New Variables</a></li>
<li class="chapter" data-level="5.9" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#data-summaries-and-grouping"><i class="fa fa-check"></i><b>5.9</b> Data Summaries and Grouping</a></li>
<li class="chapter" data-level="5.10" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#counts"><i class="fa fa-check"></i><b>5.10</b> Counts</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="functions-and-programming.html"><a href="functions-and-programming.html"><i class="fa fa-check"></i><b>6</b> Functions and Programming</a><ul>
<li class="chapter" data-level="6.1" data-path="functions-and-programming.html"><a href="functions-and-programming.html#r-functions"><i class="fa fa-check"></i><b>6.1</b> R Functions</a></li>
<li class="chapter" data-level="6.2" data-path="functions-and-programming.html"><a href="functions-and-programming.html#programming-conditional-statements"><i class="fa fa-check"></i><b>6.2</b> Programming: Conditional Statements</a><ul>
<li class="chapter" data-level="6.2.1" data-path="functions-and-programming.html"><a href="functions-and-programming.html#comparison-and-logical-operators"><i class="fa fa-check"></i><b>6.2.1</b> Comparison and Logical Operators</a></li>
<li class="chapter" data-level="6.2.2" data-path="functions-and-programming.html"><a href="functions-and-programming.html#functions-with-multiple-returns"><i class="fa fa-check"></i><b>6.2.2</b> Functions with Multiple Returns</a></li>
<li class="chapter" data-level="6.2.3" data-path="functions-and-programming.html"><a href="functions-and-programming.html#creating-functions"><i class="fa fa-check"></i><b>6.2.3</b> Creating functions</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="functions-and-programming.html"><a href="functions-and-programming.html#more-on-functions"><i class="fa fa-check"></i><b>6.3</b> More on Functions</a><ul>
<li class="chapter" data-level="6.3.1" data-path="functions-and-programming.html"><a href="functions-and-programming.html#calling-functions"><i class="fa fa-check"></i><b>6.3.1</b> Calling Functions</a></li>
<li class="chapter" data-level="6.3.2" data-path="functions-and-programming.html"><a href="functions-and-programming.html#the-...-argument"><i class="fa fa-check"></i><b>6.3.2</b> The <code>...</code> Argument</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="working-with-data-sources.html"><a href="working-with-data-sources.html"><i class="fa fa-check"></i><b>7</b> Working with Data Sources</a><ul>
<li class="chapter" data-level="7.1" data-path="working-with-data-sources.html"><a href="working-with-data-sources.html#reading-data-into-r"><i class="fa fa-check"></i><b>7.1</b> Reading Data into R</a></li>
<li class="chapter" data-level="7.2" data-path="working-with-data-sources.html"><a href="working-with-data-sources.html#reading-data-with-missing-observations"><i class="fa fa-check"></i><b>7.2</b> Reading Data with missing observations</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="spatial-data-visualization-and-analysis.html"><a href="spatial-data-visualization-and-analysis.html"><i class="fa fa-check"></i><b>8</b> Spatial Data Visualization and Analysis</a><ul>
<li class="chapter" data-level="8.1" data-path="spatial-data-visualization-and-analysis.html"><a href="spatial-data-visualization-and-analysis.html#overview"><i class="fa fa-check"></i><b>8.1</b> Overview</a><ul>
<li class="chapter" data-level="8.1.1" data-path="spatial-data-visualization-and-analysis.html"><a href="spatial-data-visualization-and-analysis.html#some-spatial-data-packages"><i class="fa fa-check"></i><b>8.1.1</b> Some Spatial Data Packages</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="spatial-data-visualization-and-analysis.html"><a href="spatial-data-visualization-and-analysis.html#motivating-data"><i class="fa fa-check"></i><b>8.2</b> Motivating Data</a></li>
<li class="chapter" data-level="8.3" data-path="spatial-data-visualization-and-analysis.html"><a href="spatial-data-visualization-and-analysis.html#reading-spatial-data-into-r"><i class="fa fa-check"></i><b>8.3</b> Reading Spatial Data into R</a></li>
<li class="chapter" data-level="8.4" data-path="spatial-data-visualization-and-analysis.html"><a href="spatial-data-visualization-and-analysis.html#coordinate-reference-systems"><i class="fa fa-check"></i><b>8.4</b> Coordinate Reference Systems</a></li>
<li class="chapter" data-level="8.5" data-path="spatial-data-visualization-and-analysis.html"><a href="spatial-data-visualization-and-analysis.html#ggmap"><i class="fa fa-check"></i><b>8.5</b> Illustration using <code>ggmap</code></a></li>
<li class="chapter" data-level="8.6" data-path="spatial-data-visualization-and-analysis.html"><a href="spatial-data-visualization-and-analysis.html#illustration-using-leaflet"><i class="fa fa-check"></i><b>8.6</b> Illustration using <code>leaflet</code></a></li>
<li class="chapter" data-level="8.7" data-path="spatial-data-visualization-and-analysis.html"><a href="spatial-data-visualization-and-analysis.html#subsetting-spatial-data"><i class="fa fa-check"></i><b>8.7</b> Subsetting Spatial Data</a><ul>
<li class="chapter" data-level="8.7.1" data-path="spatial-data-visualization-and-analysis.html"><a href="spatial-data-visualization-and-analysis.html#fetching-and-cropping-data-using-raster"><i class="fa fa-check"></i><b>8.7.1</b> Fetching and Cropping Data using <code>raster</code></a></li>
<li class="chapter" data-level="8.7.2" data-path="spatial-data-visualization-and-analysis.html"><a href="spatial-data-visualization-and-analysis.html#logical-index-and-name-subsetting"><i class="fa fa-check"></i><b>8.7.2</b> Logical, Index, and Name Subsetting</a></li>
<li class="chapter" data-level="8.7.3" data-path="spatial-data-visualization-and-analysis.html"><a href="spatial-data-visualization-and-analysis.html#spatial-subsetting-and-overlay"><i class="fa fa-check"></i><b>8.7.3</b> Spatial Subsetting and Overlay</a></li>
<li class="chapter" data-level="8.7.4" data-path="spatial-data-visualization-and-analysis.html"><a href="spatial-data-visualization-and-analysis.html#spatial-aggregation"><i class="fa fa-check"></i><b>8.7.4</b> Spatial Aggregation</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="spatial-data-visualization-and-analysis.html"><a href="spatial-data-visualization-and-analysis.html#where-to-go-from-here"><i class="fa fa-check"></i><b>8.8</b> Where to go from here</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Forestry 472: Ecological Monitoring and Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="functions-and-programming" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Functions and Programming</h1>
<p>We have been working with a wide variety of R functions, from simple functions such as <code>mean()</code>, <code>sum()</code>, and <code>length()</code> to more complex functions such as those found in the <code>dplyr</code> package. Gaining a better understanding of existing functions and the ability to write our own functions dramatically increases what you can do with R. Learning about R’s programming capabilities is an important step in gaining facility with functions. Further, functional programming basics described in this chapter are found in nearly all programming and scripting languages.</p>
<div id="r-functions" class="section level2">
<h2><span class="header-section-number">6.1</span> R Functions</h2>
<p>A function needs to have a name, perhaps some arguments, and a body of code that does something. At the end it usually returns an object (although it doesn’t have to). An important idea behind functions is that objects created within the function only exist within the function unless they are explicitly returned by the function. Returned means passing a value or object back to the environment from which the function was called. Several examples will make this more clear.</p>
<p>Let’s start with some pseudocode for a function<a href="#fn24" class="footnote-ref" id="fnref24"><sup>24</sup></a>:</p>
<pre><code>name.of.function &lt;- function(argument.1, argument.2){
  
    do something
    
    return(something)
}</code></pre>
<p>Here we are assigning the function definition to <code>name.of.function</code>. The syntax <code>function(argument.1, argument.2)</code> says we are creating a function with two arguments, with names <code>argument.1</code> and <code>argument.2</code>. What the function will do is defined between the curly brackets, i.e., where I wrote <code>do something</code>. Finally, before we close the function definition we return something we’ve created. This last step is optional, but most functions we write do return something.</p>
<p>The argument can be any type of object (like a single value, a matrix, a data frame, a vector, a logical, etc.). Here are a few simple examples of functions.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>my.first.function &lt;-<span class="st"> </span><span class="cf">function</span>() {
<span class="op">+</span><span class="st">   </span><span class="kw">print</span>(<span class="st">&quot;Ever stop to think, and forget to start again?&quot;</span>)
<span class="op">+</span><span class="st"> </span>}
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">my.first.function</span>()</code></pre>
<pre><code>[1] &quot;Ever stop to think, and forget to start again?&quot;</code></pre>
<p>Here we define a function called <code>my.first.function()</code>. This function has no arguments, i.e., nothing is defined between the parentheses in <code>function()</code>. When the function is called, by writing <code>my.first.function()</code> on the command line, the function prints a fun quote by Alan A. Milne. No values or objects are formally returned by this function.</p>
<p>Now let’s define a function that takes two arguments, the first value is raised by the second, and the result is returned.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>pow &lt;-<span class="st"> </span><span class="cf">function</span>(x, v) {
<span class="op">+</span><span class="st">   </span>result &lt;-<span class="st"> </span>x<span class="op">^</span>v
<span class="op">+</span><span class="st">   </span><span class="kw">return</span>(result)
<span class="op">+</span><span class="st"> </span>}
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">pow</span>(<span class="dv">2</span>, <span class="dv">5</span>)</code></pre>
<pre><code>[1] 32</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">pow</span>(<span class="dv">5</span>, <span class="dv">0</span>)</code></pre>
<pre><code>[1] 1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">pow</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>)</code></pre>
<pre><code>[1] 1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">pow</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)</code></pre>
<pre><code>Error in x^v: non-numeric argument to binary operator</code></pre>
<p>Not surprisingly the last test of this function throws an error. Perhaps we should modify the function to first test if both <code>x</code> and <code>v</code> are numeric. There are lots of ways to perform this check (several of which we’ll cover in a subsequent section), but for now consider this particularly convenient function call <code>stopifnot()</code>. If any logical tests in the <code>stopifnot()</code> function are <code>FALSE</code> then an error message is returned and the function evaluation is stopped. So let’s revise the <code>pow()</code> function by adding a test that ensures both arguments are numeric.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>pow &lt;-<span class="st"> </span><span class="cf">function</span>(x, v) {
<span class="op">+</span><span class="st">   </span><span class="kw">stopifnot</span>(<span class="kw">is.numeric</span>(x), <span class="kw">is.numeric</span>(v))
<span class="op">+</span><span class="st">   </span>result &lt;-<span class="st"> </span>x<span class="op">^</span>v
<span class="op">+</span><span class="st">   </span><span class="kw">return</span>(result)
<span class="op">+</span><span class="st"> </span>}
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">pow</span>(<span class="dv">2</span>, <span class="dv">5</span>)</code></pre>
<pre><code>[1] 32</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">pow</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)</code></pre>
<pre><code>Error in pow(&quot;a&quot;, &quot;b&quot;): is.numeric(x) is not TRUE</code></pre>
<p>Let’s motivate learning some more function features using data from one plot worth of tree measurements from the PEF. Below we read in tree measurements taken on plot 4 within management units 7A.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>file.name &lt;-<span class="st"> &quot;http://blue.for.msu.edu/FOR472/data/PEF-mu7A-plot4.csv&quot;</span>
<span class="op">&gt;</span><span class="st"> </span>trees.p4 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(file.name, <span class="dt">header =</span> <span class="ot">TRUE</span>)
<span class="op">&gt;</span><span class="st"> </span>trees.p4</code></pre>
<pre><code>   TreeID dbh Expf         CommonName
1  620377 4.6    5         balsam fir
2  620378 5.3    5         balsam fir
3  620379 4.8    5         balsam fir
4  620380 5.3    5       white spruce
5  620385 6.1    5 eastern white pine
6  620384 5.6    5 eastern white pine
7  620388 5.3    5 eastern white pine
8  620382 5.2    5 eastern white pine
9  620383 4.8    5 eastern white pine
10 620386 4.6    5 eastern white pine
11 620387 5.1    5 eastern white pine
12 620381 6.4    5 eastern white pine
13 620389 5.6    5 eastern white pine
14 620390 5.0    5      quaking aspen
15 620391 4.8    5      quaking aspen
16 620392 5.6    5      quaking aspen</code></pre>
<p>Here, <code>TreeID</code> is a unique tree identifier, <code>dbh</code> is the diameter at breast height measured in inches, <code>Expf</code> is the expansion factor used to convert each stem to a per acre basis, and <code>CommonName</code> is tree species. Note, this is a 1/5-th acre fixed area plot, hence the expansion factor is 5 (i.e., the inverse of the plot area).</p>
<p>We will work toward developing a function that returns basal area and stem biomass given a tree’s DBH and species. Let’s start simple with a function that returns basal area given DBH.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>ba &lt;-<span class="st"> </span><span class="cf">function</span>(dbh) {
<span class="op">+</span><span class="st">   </span>ba.sq.ft &lt;-<span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>dbh<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">144</span>)
<span class="op">+</span><span class="st">   </span><span class="kw">return</span>(ba.sq.ft)
<span class="op">+</span><span class="st"> </span>}
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>tree.<span class="fl">1.</span>dbh &lt;-<span class="st"> </span>trees.p4<span class="op">$</span>dbh[<span class="dv">1</span>]
<span class="op">&gt;</span><span class="st"> </span><span class="kw">ba</span>(tree.<span class="fl">1.</span>dbh)</code></pre>
<pre><code>[1] 0.1154</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">ba</span>(trees.p4<span class="op">$</span>dbh)</code></pre>
<pre><code> [1] 0.1154 0.1532 0.1257 0.1532 0.2029 0.1710 0.1532
 [8] 0.1475 0.1257 0.1154 0.1419 0.2234 0.1710 0.1364
[15] 0.1257 0.1710</code></pre>
<p>A few things to notice here. Our function name is <code>ba</code>, it takes DBH as an argument, and returns basal area in square feet. The formula in the <code>ba()</code> function assumes DBH is given in inches. We tested the function twice. The first call to <code>ba()</code> passes in DBH for the first tree in <code>trees.p4</code> and returns the corresponding basal area. The second call to <code>ba()</code> passes in the DBH vector for trees in <code>trees.p4</code> and returns the corresponding basal area vector.</p>
<p>Now let’s think about modifying our function to return biomass estimates given DBH and species. We can use allometric equations published by <span class="citation">Jenkins et al. (<a href="#ref-jenkins03">2003</a>)</span> that take the form</p>
<p><span class="math display" id="eq:jenkBio">\[\begin{equation}
  bm = \exp(\beta_0 + \beta_1 \ln(DBH))
  \tag{6.1}
\end{equation}\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(bm\)</span> is total aboveground biomass (km) for trees 2.5 cm DBH and larger</li>
<li>DBH is diameter at breast height in cm</li>
<li><span class="math inline">\(\exp\)</span> is the exponential function</li>
<li><span class="math inline">\(\ln\)</span> is the natural logarithm, i.e., inverse function of the exponential function</li>
</ul>
<p>Table 4 in <span class="citation">Jenkins et al. (<a href="#ref-jenkins03">2003</a>)</span> provides species specific values for the regression coefficients <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>. Table <a href="functions-and-programming.html#tab:jenks">6.1</a> below provides the regression coefficients for the species in our PEF plot 4 data.</p>
<table>
<caption><span id="tab:jenks">TABLE 6.1: </span>Parameters for estimating total aboveground biomass for species in the United States</caption>
<thead>
<tr class="header">
<th align="left">species</th>
<th align="right">beta.0</th>
<th align="right">beta.1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">quaking aspen</td>
<td align="right">-2.209</td>
<td align="right">2.387</td>
</tr>
<tr class="even">
<td align="left">balsam fir</td>
<td align="right">-2.538</td>
<td align="right">2.481</td>
</tr>
<tr class="odd">
<td align="left">white spruce</td>
<td align="right">-2.077</td>
<td align="right">2.332</td>
</tr>
<tr class="even">
<td align="left">eastern white pine</td>
<td align="right">-2.536</td>
<td align="right">2.435</td>
</tr>
</tbody>
</table>
<p>Here are some things we’ll need to accommodate in our function:</p>
<ol style="list-style-type: decimal">
<li>Jenkins allometric equations are parameterized for cm DBH, so the PEF’s DBH will need to be converted from inches to cm.</li>
<li>There is a different set of regression coefficients for each species, so we’ll need to pass in species and have the function apply the correct set of regression coefficients.</li>
</ol>
<p>No problem addressing the first point in the list above, we can easily convert inches to cm. However, the second point will require some conditional statement tests. We’ll tackle this in the next section.</p>
</div>
<div id="programming-conditional-statements" class="section level2">
<h2><span class="header-section-number">6.2</span> Programming: Conditional Statements</h2>
<p>We often want to apply different code conditional on characteristics of the data or objects at hand. This can be accomplished using an <code>if()</code> function. The argument of the <code>if()</code> function is a single logical value, i.e., <code>TRUE</code> or <code>FALSE</code>. If <code>TRUE</code>, the code within the <code>if()</code> function is evaluated. If <code>FALSE</code>, the <code>if()</code> function is skipped. Consider this simple example.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>my.if.example &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
<span class="op">+</span><span class="st">   </span><span class="cf">if</span> (x) {
<span class="op">+</span><span class="st">     </span><span class="kw">print</span>(<span class="st">&quot;x is TRUE&quot;</span>)
<span class="op">+</span><span class="st">   </span>}
<span class="op">+</span><span class="st">   </span>
<span class="op">+</span><span class="st">   </span><span class="cf">if</span> (<span class="op">!</span>x) {
<span class="op">+</span><span class="st">     </span><span class="kw">print</span>(<span class="st">&quot;x is FALSE&quot;</span>)
<span class="op">+</span><span class="st">   </span>}
<span class="op">+</span><span class="st"> </span>}
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">my.if.example</span>(<span class="ot">TRUE</span>)</code></pre>
<pre><code>[1] &quot;x is TRUE&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">my.if.example</span>(<span class="ot">FALSE</span>)</code></pre>
<pre><code>[1] &quot;x is FALSE&quot;</code></pre>
<p>To better understand and use <code>if()</code> statements, we need to understand comparison operators and logical operators.</p>
<div id="comparison-and-logical-operators" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Comparison and Logical Operators</h3>
<p>We have made use of some of the comparison operators in R. These include</p>
<ul>
<li>Equal: <code>==</code></li>
<li>Not equal: <code>!=</code></li>
<li>Greater than: <code>&gt;</code></li>
<li>Less than: <code>&lt;</code></li>
<li>Greater than or equal to: <code>&gt;=</code></li>
<li>Less than or equal to: <code>&lt;=</code></li>
</ul>
<p>Special care needs to be taken with the <code>=</code> and <code>!=</code> operators because of how numbers are represented on computers.</p>
<p>There are also three logical operators, with two variants of the “and” operator and the “or” operator.</p>
<ul>
<li>and: Either <code>&amp;</code> or <code>&amp;&amp;</code></li>
<li>or: Either <code>|</code> or <code>||</code></li>
<li>not: <code>!</code></li>
</ul>
<p>The “double” operators <code>&amp;&amp;</code> and <code>||</code> just examine the first element of the two vectors, whereas the “single” operators <code>&amp;</code> and <code>|</code> compare element by element.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>) <span class="op">||</span><span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>)</code></pre>
<pre><code>[1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>) <span class="op">|</span><span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>)</code></pre>
<pre><code>[1]  TRUE  TRUE FALSE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>)</code></pre>
<pre><code>[1] FALSE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>) <span class="op">&amp;</span><span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>)</code></pre>
<pre><code>[1] FALSE  TRUE FALSE</code></pre>
<p>Often we want to evaluate one expression if the condition is true, and evaluate a different expression if the condition is false. That is accomplished using the <code>else if()</code> statement. Here we determine whether a number is positive, negative, or zero.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>sign &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
<span class="op">+</span><span class="st">   </span><span class="cf">if</span> (x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) {
<span class="op">+</span><span class="st">     </span><span class="kw">print</span>(<span class="st">&quot;the number is negative&quot;</span>)
<span class="op">+</span><span class="st">   </span>} <span class="cf">else</span> <span class="cf">if</span> (x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) {
<span class="op">+</span><span class="st">     </span><span class="kw">print</span>(<span class="st">&quot;the number is positive&quot;</span>)
<span class="op">+</span><span class="st">   </span>} <span class="cf">else</span> {
<span class="op">+</span><span class="st">     </span><span class="kw">print</span>(<span class="st">&quot;the number is zero&quot;</span>)
<span class="op">+</span><span class="st">   </span>}
<span class="op">+</span><span class="st"> </span>}
<span class="op">&gt;</span><span class="st"> </span><span class="kw">sign</span>(<span class="dv">3</span>)</code></pre>
<pre><code>[1] &quot;the number is positive&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">sign</span>(<span class="op">-</span><span class="dv">3</span>)</code></pre>
<pre><code>[1] &quot;the number is negative&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">sign</span>(<span class="dv">0</span>)</code></pre>
<pre><code>[1] &quot;the number is zero&quot;</code></pre>
<p>Notice the sequence of conditional tests starts with <code>if()</code>. If this is not <code>TRUE</code>, moves to the <code>else if()</code> statement. If this is not <code>TRUE</code>, the sequence is terminated in an <code>else</code>. That final <code>else</code> acts as a catchall when all conditional tests above it are <code>FALSE</code>. Above, we have only one <code>else if</code> test, but you can have as many as you need, e.g., see the example below.</p>
<p>Okay, let’s return to our PEF example and develop a function that applies the regression equation <a href="functions-and-programming.html#eq:jenkBio">(6.1)</a> using species specific regression coefficients given in Table <a href="functions-and-programming.html#tab:jenks">6.1</a>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>bio &lt;-<span class="st"> </span><span class="cf">function</span>(dbh.in, species) {
<span class="op">+</span><span class="st">   </span>
<span class="op">+</span><span class="st">   </span>dbh.cm &lt;-<span class="st"> </span>dbh.in <span class="op">*</span><span class="st"> </span><span class="fl">2.54</span>
<span class="op">+</span><span class="st">   </span>
<span class="op">+</span><span class="st">   </span><span class="cf">if</span> (dbh.cm <span class="op">&lt;</span><span class="st"> </span><span class="fl">2.5</span>) {
<span class="op">+</span><span class="st">     </span><span class="kw">stop</span>(<span class="st">&quot;Only valid for trees greater than 2.5 cm DBH&quot;</span>)
<span class="op">+</span><span class="st">   </span>}
<span class="op">+</span><span class="st">   </span>
<span class="op">+</span><span class="st">   </span><span class="cf">if</span> (species <span class="op">==</span><span class="st"> &quot;quaking aspen&quot;</span>) {
<span class="op">+</span><span class="st">     </span>beta<span class="fl">.0</span> &lt;-<span class="st"> </span><span class="fl">-2.2094</span>
<span class="op">+</span><span class="st">     </span>beta<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="fl">2.3867</span>
<span class="op">+</span><span class="st">   </span>} <span class="cf">else</span> <span class="cf">if</span> (species <span class="op">==</span><span class="st"> &quot;balsam fir&quot;</span>) {
<span class="op">+</span><span class="st">     </span>beta<span class="fl">.0</span> &lt;-<span class="st"> </span><span class="fl">-2.5384</span>
<span class="op">+</span><span class="st">     </span>beta<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="fl">2.4814</span>
<span class="op">+</span><span class="st">   </span>} <span class="cf">else</span> <span class="cf">if</span> (species <span class="op">==</span><span class="st"> &quot;white spruce&quot;</span>) {
<span class="op">+</span><span class="st">     </span>beta<span class="fl">.0</span> &lt;-<span class="st"> </span><span class="fl">-2.0773</span>
<span class="op">+</span><span class="st">     </span>beta<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="fl">2.3323</span>
<span class="op">+</span><span class="st">   </span>} <span class="cf">else</span> <span class="cf">if</span> (species <span class="op">==</span><span class="st"> &quot;eastern white pine&quot;</span>) {
<span class="op">+</span><span class="st">     </span>beta<span class="fl">.0</span> &lt;-<span class="st"> </span><span class="fl">-2.5356</span>
<span class="op">+</span><span class="st">     </span>beta<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="fl">2.4349</span>
<span class="op">+</span><span class="st">   </span>} <span class="cf">else</span> {
<span class="op">+</span><span class="st">     </span><span class="kw">stop</span>(<span class="st">&quot;No coefficients available for the given species&quot;</span>)
<span class="op">+</span><span class="st">   </span>}
<span class="op">+</span><span class="st">   </span>
<span class="op">+</span><span class="st">   </span>bm &lt;-<span class="st"> </span><span class="kw">exp</span>(beta<span class="fl">.0</span> <span class="op">+</span><span class="st"> </span>beta<span class="fl">.1</span> <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(dbh.cm))
<span class="op">+</span><span class="st">   </span>
<span class="op">+</span><span class="st">   </span><span class="kw">return</span>(bm)
<span class="op">+</span><span class="st"> </span>}
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">bio</span>(<span class="dv">5</span>, <span class="st">&quot;balsam fir&quot;</span>)</code></pre>
<pre><code>[1] 43.31</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">bio</span>(<span class="dv">2</span>, <span class="st">&quot;quaking aspen&quot;</span>)</code></pre>
<pre><code>[1] 5.311</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">bio</span>(<span class="dv">3</span>, <span class="st">&quot;Quaking aspen&quot;</span>)</code></pre>
<pre><code>Error in bio(3, &quot;Quaking aspen&quot;): No coefficients available for the given species</code></pre>
<p>Consider our new function <code>bio()</code> above that takes DBH (in) and species common name as arguments, <code>dbh.in</code> and <code>species</code>, respectively, and returns biomass (kg). The first line in the function’s body converts DBH in inches to cm, because that’s what the <span class="citation">Jenkins et al. (<a href="#ref-jenkins03">2003</a>)</span> biomass equation expects. The <code>if()</code> statement that follows checks if DBH is at least 2.5 cm. If DBH is less than 2.5 cm then the <code>stop()</code> function stops the <code>bio()</code> function and reports the error message “Only valid for trees greater than 2.5 cm DBH.” Next we go into a series of <code>if()</code> and <code>else if()</code> statements that identify the species specific values for the regression coefficients <code>beta.0</code> and <code>beta.1</code>. If the <code>species</code> argument is not one of the four species for which we have regression coefficients then the last <code>else</code> is reached and the code <code>stop()</code> is executed, which again terminates the <code>bio()</code> function followed by an explanation about why the function was stopped. The second to last line in <code>bio()</code>’s body is the regression equation defined in equation <a href="functions-and-programming.html#eq:jenkBio">(6.1)</a>, now with the species specific regression coefficients <code>beta.0</code> and <code>beta.1</code>. Finally, <code>return(bm)</code> returns the resulting biomass (kg).</p>
</div>
<div id="functions-with-multiple-returns" class="section level3">
<h3><span class="header-section-number">6.2.2</span> Functions with Multiple Returns</h3>
<p>We often want a function to return multiple objects. This is most easily done by making the return object be a list with elements corresponding to the different objects we want returned. Recall lists can hold any combination of R objects. Here’s a simple example. Let’s make a function called <code>quick.summary</code> that returns the mean, median, and variance of a numeric vector. We can try it out using the DBH vector from <code>trees.p4</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>quick.summary &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
<span class="op">+</span><span class="st">   </span>
<span class="op">+</span><span class="st">   </span>a &lt;-<span class="st"> </span><span class="kw">mean</span>(x)
<span class="op">+</span><span class="st">   </span>b &lt;-<span class="st"> </span><span class="kw">median</span>(x)
<span class="op">+</span><span class="st">   </span>c &lt;-<span class="st"> </span><span class="kw">var</span>(x)
<span class="op">+</span><span class="st">   </span>
<span class="op">+</span><span class="st">   </span>result &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">mean =</span> a, <span class="dt">median =</span> b, <span class="dt">var =</span> c)
<span class="op">+</span><span class="st">   </span>
<span class="op">+</span><span class="st">   </span><span class="kw">return</span>(result)
<span class="op">+</span><span class="st"> </span>}
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">quick.summary</span>(trees.p4<span class="op">$</span>dbh)</code></pre>
<pre><code>$mean
[1] 5.256

$median
[1] 5.25

$var
[1] 0.264</code></pre>
</div>
<div id="creating-functions" class="section level3">
<h3><span class="header-section-number">6.2.3</span> Creating functions</h3>
<p>Creating very short functions at the command prompt is a reasonable strategy. For longer functions, one option is to write the function in a script window and then submit the whole function. Or a function can be written in any text editor, saved as a plain text file (possibly with a <code>.R</code> extension), and then read into R using the <code>source()</code> command.</p>
</div>
</div>
<div id="more-on-functions" class="section level2">
<h2><span class="header-section-number">6.3</span> More on Functions</h2>
<p>Understanding functions deeply requires a careful study of the scoping rules of R, as well as a good understanding of environments in R. That’s beyond the scope of this book, but we will briefly discuss some issues that are most salient. For a more in-depth treatment, see “Advanced R” by Hadley Wickham, especially the chapters on functions and environments.</p>
<div id="calling-functions" class="section level3">
<h3><span class="header-section-number">6.3.1</span> Calling Functions</h3>
<p>When using a function, the function arguments can be specified in three ways:</p>
<ul>
<li>By the full name of the argument.</li>
<li>By the position of the argument.</li>
<li>By a partial name of the argument.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>tmp_function &lt;-<span class="st"> </span><span class="cf">function</span>(first.arg, second.arg, third.arg, 
<span class="op">+</span><span class="st">   </span>fourth.arg) {
<span class="op">+</span><span class="st">   </span><span class="kw">return</span>(<span class="kw">c</span>(first.arg, second.arg, third.arg, fourth.arg))
<span class="op">+</span><span class="st"> </span>}
<span class="op">&gt;</span><span class="st"> </span><span class="kw">tmp_function</span>(<span class="dv">34</span>, <span class="dv">15</span>, <span class="dt">third.arg =</span> <span class="dv">11</span>, <span class="dt">fou =</span> <span class="dv">99</span>)</code></pre>
<pre><code>[1] 34 15 11 99</code></pre>
<p>Positional matching of arguments is convenient, but should be used carefully, and probably limited to the first few and most commonly used arguments in a function. Partial matching also has some pitfalls</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>tmp_function &lt;-<span class="st"> </span><span class="cf">function</span>(first.arg, fourth.arg) {
<span class="op">+</span><span class="st">   </span><span class="kw">return</span>(<span class="kw">c</span>(first.arg, fourth.arg))
<span class="op">+</span><span class="st"> </span>}
<span class="op">&gt;</span><span class="st"> </span><span class="kw">tmp_function</span>(<span class="dv">1</span>, <span class="dt">f =</span> <span class="dv">2</span>)</code></pre>
<pre><code>Error in tmp_function(1, f = 2): argument 2 matches multiple formal arguments</code></pre>
<p>A partially specified argument must unambiguously match exactly one argument.</p>
</div>
<div id="the-...-argument" class="section level3">
<h3><span class="header-section-number">6.3.2</span> The <code>...</code> Argument</h3>
<p>In defining a function, a special argument denoted by <code>...</code> can be used. Sometimes this is called the “ellipsis” argument, sometimes the “three dot” argument, sometimes the “dot dot dot” argument, etc. The R language definition <a href="https://cran.r-project.org/doc/manuals/r-release/R-lang.html" class="uri">https://cran.r-project.org/doc/manuals/r-release/R-lang.html</a> describes the argument in this way:</p>
<blockquote>
<p>The special type of argument `…’ can contain any number of supplied arguments. It is used for a variety of purposes. It allows you to write a function that takes an arbitrary number of arguments. It can be used to absorb some arguments into an intermediate function which can then be extracted by functions called subsequently.</p>
</blockquote>
<p>Consider for example the <code>sum()</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">sum</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</code></pre>
<pre><code>[1] 15</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">sum</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">90</span>))</code></pre>
<pre><code>[1] 112</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">sum</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">90</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</code></pre>
<pre><code>[1] 118</code></pre>
<p>Think about writing such a function. There is no way to predict in advance the number of arguments a user might specify. So the function is defined with <code>...</code> as the first argument:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>sum</code></pre>
<pre><code>function (..., na.rm = FALSE)  .Primitive(&quot;sum&quot;)</code></pre>
<p>This is true of many commonly-used functions in R such as <code>c()</code> among others.</p>
<p>Next, consider a function which calls another function in its body. For example, suppose that a collaborator always supplies comma delimited files which have five lines of description, followed by a line containing variable names, followed by the data. You are tired of having to specify <code>skip = 5</code>, <code>header = TRUE</code>, and <code>sep = &quot;,&quot;</code> to <code>read.table()</code> and want to create a function <code>my.read()</code> which uses these as defaults.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>my.read &lt;-<span class="st"> </span><span class="cf">function</span>(file, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="dt">skip =</span> <span class="dv">5</span>, 
<span class="op">+</span><span class="st">   </span>...) {
<span class="op">+</span><span class="st">   </span><span class="kw">read.table</span>(<span class="dt">file =</span> file, <span class="dt">header =</span> header, <span class="dt">sep =</span> sep, 
<span class="op">+</span><span class="st">     </span><span class="dt">skip =</span> skip, ...)
<span class="op">+</span><span class="st"> </span>}</code></pre>
<p>The <code>...</code> in the definition of <code>my.read()</code> allows the user to specify other arguments, for example, <code>stringsAsFactors = FALSE</code>. These will be passed on to the <code>read.table()</code> function. In fact, that is how <code>read.csv()</code> is defined.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>read.csv</code></pre>
<pre><code>function (file, header = TRUE, sep = &quot;,&quot;, quote = &quot;\&quot;&quot;, dec = &quot;.&quot;, 
    fill = TRUE, comment.char = &quot;&quot;, ...) 
read.table(file = file, header = header, sep = sep, quote = quote, 
    dec = dec, fill = fill, comment.char = comment.char, ...)
&lt;bytecode: 0x5645eccc2e38&gt;
&lt;environment: namespace:utils&gt;</code></pre>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-jenkins03">
<p>Jenkins, Jennifer C., David C. Chojnacky, Linda S. Heath, and Richard A. Birdsey. 2003. “National-Scale Biomass Estimators for United States Tree Species.” <em>Forest Science</em> 49 (1): 12–35.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="24">
<li id="fn24"><p>Pseudocode is notation resembling a simplified programming language, used in program design.<a href="functions-and-programming.html#fnref24" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="manipulating-data-with-dplyr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="working-with-data-sources.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["bookdown.pdf"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
